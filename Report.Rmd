---
title: "Predicting Pokémon Types Using Clustering and Classification"
subtitle: "University of Toronto - STA2201 - Winter 2025"
author: "Justin Zhang, Isaac Baguisa, Alex Faassen"
date: "2025-04-04"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Abstract

- Report Summary
- Link GitHub?

## Contributions:

- Justin Zhang:
- Isaac Baguisa:
- Alex Faassen:

# Introduction

- Research Question
- Motivation
- Context

Over the past two decades, Pokémon has evolved from a niche Gameboy game into a global multimedia franchise encompassing anime, trading cards, e-sports competitions, and mobile applications. For many who grew up in the late 2000s and early 2010s, the world of Pokémon was a formative part of childhood entertainment alongside cultural staples like Mario Bros. and Zelda. As Pokémon continues to captivate audiences across generations, its community-oriented game design and well-structured universe presents an intriguing opportunity for data analysis. In this project, we investigate whether a Pokémon's type—a categorical label used in-game to denote elemental or behavioral characteristics such as Fire, Water, or Grass—can be inferred from its visual appearance and numerical attributes using statistical learning techniques.

Our primary research question is:
\textit{Can clustering and classification methods uncover or predict a Pokémon’s type based on its image and statstical features?}

The Pokémon type system serves not only as a game mechanic but also as a conceptual grouping based on traits like colour, strength, and theme. We aim to explore whether these groupings have an underlying statistical structure that can be detected through dimensionality reduction, clustering, and classification algorithms. This analysis will provide insight into the extent to which a Pokémon’s type is reflected in its appearance and physical characteristics, or whether it is a more arbitrary design choice by game developers.

# Data Description

- Data description + overview
- Pre-processing
- Visualizations and summary stats: Stats head; Example image; Mean image

Our analysis is based on two publicly available Kaggle datasets:

## 1. Pokémon Stats Dataset

**URL:** [The Complete Pokemon Dataset](https://www.kaggle.com/datasets/rounakbanik/pokemon)

This structured dataset contains 41 variables for 801 Pokémon. These features include:

- **Physical attributes:** height, weight, base experience
- **Combat statistics:** HP (Health Points), attack, defense, special attack, special defense, speed
- **Categorical indicators:** Legendary status, abilities, and generation
- **Primary and secondary type labels**

All variables are numeric or have been encoded numerically (e.g., legendary status as 0/1). There are no missing values. **Notably**, We only consider primary type labels for this project to maintain a single-label classification structure.

```{r include = FALSE}
## Libraries
library(png)
library(ggplot2)
library(dplyr)
library(forcats)
library(tidyr)

## Load Data
load("Data/pokemon.RData")
```

```{r echo=FALSE}
## TO DO: Visuals
# - Table of summary stats for key features
# - Histogram of pokemon by primary type
# - Boxplots comparing attack/sp_attack across types

## Table of summary stats for key features
key_features <- c("hp", "attack", "defense", "sp_attack", "sp_defense", "speed", "height_m", "weight_kg")

# Summary stats
summary_table <- stats %>%
  select(all_of(key_features)) %>%
  summarise(across(everything(), list(
    mean = ~round(mean(.x, na.rm = TRUE), 2),
    sd = ~round(sd(.x, na.rm = TRUE), 2),
    min = ~min(.x, na.rm = TRUE),
    q1 = ~quantile(.x, 0.25, na.rm = TRUE),
    median = ~median(.x, na.rm = TRUE),
    q3 = ~quantile(.x, 0.75, na.rm = TRUE),
    max = ~max(.x, na.rm = TRUE)
  ), .names = "{.col}_{.fn}")) %>%
  pivot_longer(cols = everything(),
               names_to = c("Feature", "Statistic"),
               names_pattern = "^(.*)_(mean|sd|min|q1|median|q3|max)$",
               values_to = "Value") %>%
  pivot_wider(names_from = Statistic, values_from = Value)

# Print
print(summary_table)
```

```{r echo=FALSE}
type_cols <- c(
  "bug" = "#A8B820", "dark" = "#705848", "dragon" = "#7038F8", "electric" = "#F8D030",
  "fairy" = "#EE99AC", "fighting" = "#C03028", "fire" = "#F08030", "flying" = "#A890F0",
  "ghost" = "#705898", "grass" = "#78C850", "ground" = "#E0C068", "ice" = "#98D8D8",
  "normal" = "#A8A878", "poison" = "#A040A0", "psychic" = "#F85888", "rock" = "#B8A038",
  "steel" = "#B8B8D0", "water" = "#6890F0"
)

# Top N primary types (by freq)
top5_types <- stats %>%
  mutate(type1 = tolower(type1)) %>%
  count(type1, sort = TRUE) %>%
  top_n(5, n)

filtered_data <- stats %>%
  mutate(type1 = tolower(type1)) %>%
  filter(type1 %in% top5_types$type1) %>%
  mutate(type1 = fct_infreq(type1)) 

## Bar chart of pokemon by primary type
type_freq = ggplot(filtered_data, aes(x = fct_infreq(type1), fill = type1)) +
  geom_bar() +
  scale_fill_manual(values = type_cols) +
  labs(
    title = "Top 5 Pokémon Types",
    x = "Primary Type",
    y = "Count"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1), legend.position = "left")

## Boxplots comparing attack/defense across types
# Boxplot of Attack by Type
type_attack = ggplot(filtered_data, aes(x = type1, y = attack, fill = type1)) +
  geom_boxplot() +
  scale_fill_manual(values = type_cols) +
  labs(
    title = "Attack Stat Distributions",
    x = "Primary Type",
    y = "Attack Stat"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1), legend.position = "none")

# Print
type_freq + type_attack
```

## 2. Pokémon Image Dataset

**URL:** [Pokemon Image Dataset](https://www.kaggle.com/datasets/vishalsubbiah/pokemon-images-and-types)

The Pokémon Image Dataset consists of 809 PNG files representing unique images of Pokémon from generations 1 through 7. Each file consists of a 3-dimensional array of dimensions 120 by 120 by 4. The first 2 slices represent a 120 by 120 grid of pixels, and the 3rd slice represents the 4 RGBA channels (Red, Blue, Green, Alpha), the colour and transparency assignments of each pixel.

```{r echo = FALSE}
## TO DO: Side by side pictures of 2 pokemon with their name + primary type
# Libraries
library(png)
library(ggplot2)
library(patchwork)

# Pokemon
ex1 = readPNG("Data/images/pikachu.png")
ex2 = readPNG("Data/images/charizard.png")
p1 = ggplot()+
  annotation_raster(ex1,xmin=-Inf,xmax=+Inf,ymin=-Inf,ymax= +Inf) +
  labs(title = "Pikachu")
p2 = ggplot()+
  annotation_raster(ex2,xmin=-Inf,xmax=+Inf,ymin=-Inf,ymax= +Inf) +
  labs(title = "Charizard")
print(p1 + p2)
```

## Pre-processing

For the images, we begin by flattening each PNG into a (120x120x4) 57600-element vector, each pixel and RGBA value representing a feature. Binding these vectors into a table identified by Pokémon name gives us a usable dataset. To integrate image features with the stats dataset, we filter both tables to common Pokémon requiring several name formatting adjustments to account for unusual characters. Finally, we match the row-order of both datasets, resulting in two easily transferable Pokémon datasets.

# Methodology

- What methods/models were chosen and why w.r.t. research question

## Image Dimension Reduction

- Image PCA

### Pokemon Type Clustering Patterns

- Image PCA results
- t-SNE/UMAP on Pokemon Type

## Unsupervised Model

- e.g. Weighted K-means

## Supervised Model

- e.g. Log reg, KNN, LDA

# Results

- Summarize findings (include tables/plots)
- Interpret results w.r.t. research question

# Discussion

- Discuss model performance
- Limitations of methodology
  - Potential sources of bias
- Challenges encountered
- Recommendations for overcoming these + improvements for future work

**Notes:**
- Dual-typing might be causing some difficulties - adding complexity.
- Perhaps other approaches, such as deep learning, might do better.

# References

- Use `knitcitations`? - manual easier?

# (Optional) Appendix

- If we have any "extra" non-essential tables that we want to include, but don't want contributing to the page limit.

