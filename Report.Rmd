---
title: "Predicting Pokémon Types Using Clustering and Classification"
subtitle: "University of Toronto - STA2201 - Winter 2025"
author: "Justin Zhang, Isaac Baguisa, Alex Faassen"
date: "2025-04-04"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warnings = FALSE)
```

```{r include = FALSE, echo = FALSE}
## Libraries
library(ggplot2)
library(patchwork)
library(forcats)
library(knitr)
```

## Abstract

- Report Summary
- Link GitHub?

## Contributions:

- Justin Zhang:
- Isaac Baguisa:
- Alex Faassen:

# Introduction

- Research Question
- Motivation
- Context

Over the past two decades, Pokémon has evolved from a niche Gameboy game into a global multimedia franchise encompassing anime, trading cards, e-sports competitions, and mobile applications. For many who grew up in the late 2000s and early 2010s, the world of Pokémon was a formative part of childhood entertainment alongside cultural staples like Mario Bros. and Zelda. As Pokémon continues to captivate audiences across generations, its community-oriented game design and well-structured universe presents an intriguing opportunity for data analysis. In this project, we investigate whether a Pokémon's type—a categorical label used in-game to denote elemental or behavioral characteristics such as Fire, Water, or Grass—can be inferred from its visual appearance and numerical attributes using statistical learning techniques.

Our primary research question is:
\textit{Can clustering and classification methods uncover or predict a Pokémon’s type based on its image and statstical features?}

The Pokémon type system serves not only as a game mechanic but also as a conceptual grouping based on traits like colour, strength, and theme. We aim to explore whether these groupings have an underlying statistical structure that can be detected through dimensionality reduction, clustering, and classification algorithms. This analysis will provide insight into the extent to which a Pokémon’s type is reflected in its appearance and physical characteristics, or whether it is a more arbitrary design choice by game developers.

# Data Description

- Data description + overview
- Pre-processing
- Visualizations and summary stats: Stats head; Example image; Mean image

Our analysis is based on two publicly available Kaggle datasets:

## 1. Pokémon Image Dataset

**URL:** [Pokemon Image Dataset](https://www.kaggle.com/datasets/vishalsubbiah/pokemon-images-and-types)

The Pokémon Image Dataset consists of 809 PNG files representing unique images of Pokémon from generations 1 through 7. Each file consists of a 3-dimensional array of dimensions 120 by 120 by 4. The first 2 slices represent a 120 by 120 grid of pixels, and the 3rd slice represents the 4 RGBA channels (Red, Blue, Green, Alpha), the colour and transparency assignments of each pixel.

```{r echo = FALSE}
## Side by side pictures of 2 pokemon with their name + primary type
load("Figures/data_description.RData")
p1 + p2 # Uses library(patchwork) - loaded at top.
```
**ADD ANNOTATIONS**

## 2. Pokémon Stats Dataset

**URL:** [The Complete Pokemon Dataset](https://www.kaggle.com/datasets/rounakbanik/pokemon)

This structured dataset contains 41 variables for 801 Pokémon. These features include:

- **Physical attributes:** height, weight, base experience
- **Combat statistics:** HP (Health Points), attack, defense, special attack, special defense, speed
- **Categorical indicators:** Legendary status, abilities, and generation
- **Primary and secondary type labels**

All variables are numeric or have been encoded numerically (e.g., legendary status as 0/1). **Notably**, we only consider primary type labels for this project to maintain a single-label classification structure.

```{r echo=FALSE}
## TO DO: Visuals
# - Table of summary stats for key features
# - Histogram of pokemon by primary type
# - Boxplots comparing attack/sp_attack across types

## Summary_stats
# summary_table
knitr::kable(summary_table, caption = "Summary Statistics for Key Features")
```
**ADD ANNOTATIONS**

```{r echo=FALSE}
# Print
type_freq + type_attack
```
**ADD ANNOTATIONS**

## Pre-processing

For the images, we begin by flattening each PNG into a (120x120x4) 57600-element vector, each pixel and RGBA value representing a feature. Binding these vectors into a table identified by Pokémon name gives us a usable dataset. To integrate image features with the stats dataset, we filter both tables to common Pokémon requiring several name formatting adjustments to account for unusual characters. Finally, we match the row-order of both datasets, resulting in two easily transferable Pokémon datasets.

# Methodology

- What methods/models were chosen and why w.r.t. research question

## Image Dimension Reduction

- Image PCA results
- t-SNE/UMAP on Pokemon Type

To explore whether Pokémon types are distinguishable based on their visual features, we look to apply clustering algorithms to their images. Since we are working with high-dimensional data (801x57600), we first apply dimension reduction techniques to mitigate the curse of dimensionality intending to apply clustering algorithms to the compressed images. Our primary tools were Principal Component Analysis (PCA) and Uniform Manifold Approximation and Projection (UMAP). In their own right, these methods also help us determine if type-based structure is embedded in high-dimensional image representations.

### Principal Component Analysis (PCA)

We began with PCA, a linear technique that identifies the directions of maximal variance in the dataset. After centering the flattened image matrix, we applied PCA and examined the cumulative variance explained by the resulting principal components.

```{r echo=FALSE}
## Scree plot + Biplot
load("Figures/img_dim_red.RData")
cumVE_biplot_img
```

- Biplot breakdown
- Loading vectors (add figures in appendix)
- Cumulative VE plot

```{r echo=FALSE}
## Image compression
abomasnow_og + abomasnow_compressed
```

- Image compression

### UMAP

- Plot?
- Breakdown

## Unsupervised Model

```{r, echo=FALSE}
load("Figures/cluster_res.RData")
```

This section evaluates if unsupervised models such as K-means clustering can accurately recover Pokemon types based on their numeric stats and image features. Specifically, we explore standard K-means clustering, K-means++ initialization, and weighted K-means clustering methods (distance-based weighting). We used dimensionality reduction methods such as PCA and UMAP before clustering the image data. We examine two Pokemon datasets, one including numeric stats (attack, defense, speed) and one including image data. Numeric missing data was imputed using K-Nearest Neighbours (KNN) imputation, and features with zero variance were removed. PCA was applied to both numeric data and image data to reduce dimensionality. For the numeric stats dataset, 20 principal components that explained 90% of the variance were kept. We also applied clustering methods on the UMAP features from the images to compare its accuracy against PCA.

```{r, echo=FALSE, fig.height = 5, out.width = "80%", fig.cap="Visualization of true Pokemon types on PC1 and PC2"}
plt_true
```

We set the initial number of clusters (k=18) to match the total number of Pokemon types. The clustering methods were compared using within sum of squares (wss), between sum of squares (bss), CH index, and accuracy. The labels of each cluster was assigned by labelling each cluster the most common type in that cluster - this allows us to compute accuracy by comparing the assigned labels with the true types.

Clustering performance was also assessed by determining alternative optimal cluster numbers, identified through the elbow method (wss), silhouette score, CH index, and gap statistics. Testing for different number of clusters may help identify if there are consistent trends with the grouping of certain types of Pokemon, such as if there are certain types consistently grouped together. Additionally, if the optimal number of clusters is small, it suggests that the data might naturally form fewer larger groups. Comparing standard K-means and K-means++, the clusters had a wss of 12613.8 and 12848.89 respectively, and bss of 14360.22 and 14125.13 respectively. This suggests the stats dataset creates more distinct clusters with standard K-means clustering.

```{r, echo = FALSE, fig.height = 5, out.width = "80%", fig.cap="Visualization of Pokemon types from K-means clustering on PC1 and PC2"}
plt_km_stats
```


The clustering performance on numeric Pokemon stats resulted in moderate accuracy, with standard K-means and K-means++ methods performing similarly (approximately 52.4% - 52.9% accuracy). Weighted K-means had much lower accuracy (20.3%), suggesting that the distance based weighting did not benefit clustering with these data.

Optimal cluster methods resulted in notably fewer clusters (ranging from k = 1 to 10) than the actual number of Pokemon types (18). The elbow method suggested k = 3, silhouette suggested k = 2, CH index suggested k = 1, and gap statistics suggested k = 10. Using k = 3, the accuracy was 17.2%, which is moderate as the types remaining were grass, water and psychic, which make up about 30.5% of the dataset. Overall, these results indicates that Pokemon numeric stats do not naturally cluster into distinct groups corresponding directly to each of the 18 types.

```{r, echo=FALSE}
kable(data.frame(
  Method = c("K-means", "K-means++", "Weighted K-means", "Optimal K-means K = 3"),
  Accuracy = c(kmeans_stats_acc, kmeans_stats_pp_acc, kmeans_w_stats_acc, kmeans_stats_opt_acc)
), caption = "Clustering Method Accuracies on Stats Data")
```

In the image dataset, comparing standard K-means and K-means++, the clusters had a wss of 677488.2 and 696824.9 respectively, and bss of 288142.1 and 268805.4 respectively. This suggests the image dataset creates more distinct clusters with standard K-means clustering.

Image clusters consistently produced lower accuracy than numeric stats. Standard K-means had approximately 18.1% accuracy, while K-means++ and weighted K-means performed similarly or worse (17.4% and 14.2%, respectively). This implies image features alone were insufficient to recover Pokemon types.

Optimal cluster tuning again produced fewer optimal clusters (k = 1 to 10). Using k = 3, accuracy intuitively dropped further to 14.7%, indicating images likely contain common and general features across many Pokemon types, such as similar color or shapes, leading to ineffective cluster separations. The poor clustering accuracy highlights significant weaknesses in the image-based approach. Pokemon image characteristics appear not to strongly correlate with type when reduced to PCA features.

```{r, echo=FALSE}
kable(data.frame(
  Method = c("K-means", "K-means++", "Weighted K-means", "Optimal K-means K = 3"),
  Accuracy = c(kmeans_img_acc, kmeans_img_pp_acc, kmeans_w_img_acc, kmeans_img_opt_acc)
), caption = "Clustering Method Accuracies on Image Data")
```

### UMAP-based Clustering

UMAP dimensionality reduction was also applied on the image data to see if non-linear dimension reduction improves accuracy for recovering types. K-means with UMAP gave 18.6% accuracy and K-means++ with UMAP gave 18.2% accuracy. Although UMAP aims to uncover non-linear patterns, accuracy remained consistently low. UMAP’s nonlinear features did not significantly improve the separation of Pokemon types compared to PCA. This further confirms the difficulty in extracting type-specific visual characteristics from Pokemon image data, reinforcing the idea that image features do not map effectively onto the Pokemon types.

### Comparing Clustering Methods

Standard K-means and K-means++ gave similar performances across numeric and image datasets. Standard K-means slightly outperformed K-means++ in numeric stats, whereas K-means++ was less effective on image data. Weighted K-means consistently underperformed, which suggests that distance-based weighting do not match the structures in these datasets. Numeric stats clustering significantly outperformed image clustering, indicating that numeric stats more closely align with Pokemon types than images. 

### Standard K-Means (K=18) Interpretations

Looking deeper into the clustering results from standard K-means with k=18, we see how the K-means algorithm groups Pokemon based on their stats, independent of their actual types. This gives us an idea of whether Pokemon types with similar stats (high attack and speed, or high defense and hp) tend to cluster together. In general, it is common to see Pokemon with relatively similar attack, speed, or defensive stats cluster together, but this does not necessarily correspond to the type the Pokemon belongs to (See Table 4 in Appendix). In Table 5 in the appendix, some clusters were clearly dominated by a single type - such as water for cluster 11. There were some common clusters containing a mix of different types that could be linked through common attributes. For example, cluster 17 had ghost and psychic types dominate in this cluster - suggesting these types share common statistical features. Similarly, cluster 10 grouped many bug, grass, and poison types. Overall this suggests that statistical features like attack, defense, etc., might outweigh type-specific features when forming clusters.


## Supervised Model

- e.g. Log reg, KNN, LDA

# Results

- Summarize findings (include tables/plots)
- Interpret results w.r.t. research question

# Discussion

- Discuss model performance
- Limitations of methodology
  - Potential sources of bias
- Challenges encountered
- Recommendations for overcoming these + improvements for future work

**Notes:**
- Dual-typing might be causing some difficulties - adding complexity.
- Perhaps other approaches, such as deep learning, might do better.

## Clustering Discussion

Some things that did not work include first grouping if the Pokemon is legendary or not. Implementing K-means on these groups separately resulted in clusters with larger wss (for non-legendary group) and lower bss - indicating less distinct clusters. Additionally, due to fewer observations in the legendary grouping, this caused a reduced ability to form meaningful clusters, as the smaller sample size led to less reliable cluster centers and higher variance within the legendary group.

Overall, clustering performance varied significantly depending on the data type and method. While clustering could partially recover Pokemon types, it could not match the true labels efficiently - this suggests the structure of the data may not capture the complexity of the Pokemon types in a way that creates efficient and distinct clusters. Future analysis could incorporate other model-based clustering methods such as Gaussian mixture models.



# References

- Use `knitcitations`? - manual easier?

\newpage 

# Appendix


```{r, echo=FALSE}
kable(km_cluster_summary_stats, caption="Average Statistics Rating Across Standard K-means Clusters (Stats Data)")
```

```{r, echo=FALSE}
kable(table(comp_labels), caption = "Summary of Cluster Assignments from Standard K-means (Stats Data)")

```

